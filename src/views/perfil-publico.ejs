<%- include('partials/_head') %>

<link rel="stylesheet" href="/css/perfil.css">
<link rel="stylesheet" href="/css/navbar.css">
<link rel="stylesheet" href="/css/footer.css">

<body>

  <!-- BOTÃO VOLTAR -->
  <div class="voltar-container">
    <button class="voltar" onclick="window.history.back()">
      <img src="/assets/setinha-cinza.svg" alt="Voltar" width="25" height="25">
    </button>
  </div>

  <!-- NAVBAR -->
  <%- include('partials/_navbar') %>

  <!-- PERFIL -->
  <main class="perfil-container">

    <!-- BANNER -->
    <div class="perfil-banner">
      <img src="/assets/img-fundo-perfil.png" alt="banner" id="banner">
    </div>

    <div class="perfil-content">

      <!-- FOTO DO PERFIL (APENAS VISUALIZAÇÃO) -->
      <div class="perfil-foto">
        <img
          src="<%= (publicUser && publicUser.avatar_url) ? publicUser.avatar_url : '/assets/icon-img-perfil.png' %>"
          alt="Foto de perfil"
          id="img-perfil"
        >
      </div>

      <!-- INFO DO PERFIL (APENAS VISUALIZAÇÃO) -->
      <div class="perfil-info">
        <div class="perfil-nome-edit">
          <h2 id="nome-usuario">
            <%= publicUser && publicUser.name ? publicUser.name : 'Usuário' %>
          </h2>
        </div>

        <p id="email-usuario">
          <%= publicUser && publicUser.email ? publicUser.email : 'email@gmail.com' %>
        </p>
      </div>

      <!-- FEED DINÂMICO DO USUÁRIO -->
            <!-- FEED DE RECEITAS DO USUÁRIO (SERVER-SIDE) -->
      <div class="feed-receitas" id="feed-usuario">
        <% if (recipes && recipes.length) { %>
          <% recipes.forEach(function(r) { %>
            <div
              class="receita-post"
              onclick="window.location.href='/receitas/<%= r.id %>'"
            >
              <img
                src="<%= r.cover_image || '/assets/img-bolinho.png' %>"
                class="receita-feed-img"
                alt="<%= r.title %>"
              >
            </div>
          <% }) %>
        <% } else { %>
          <p>Esse usuário ainda não publicou nenhuma receita.</p>
        <% } %>
      </div>
    </div>
  </main>

  <%- include('partials/_footer') %>

  <script src="/js/categorias.js"></script>
  <script src="/js/navbar.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>

</body>
</html>
